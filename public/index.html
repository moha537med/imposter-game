<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Imposter Game</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">

<style>
body{
  font-family:'Cairo',sans-serif;
  background:#1f1c2c;
  color:white;
  text-align:center;
}

.container{
  width:400px;
  margin:auto;
  margin-top:50px;
}

input,select{
  width:90%;
  padding:10px;
  margin:5px 0;
  border-radius:8px;
  border:none;
}

button{
  padding:10px;
  margin:5px;
  border:none;
  border-radius:8px;
  background:#ff4b2b;
  color:white;
  cursor:pointer;
  transition:0.3s;
}

button:hover{
  transform:scale(1.05);
}

.player{
  background:#333;
  padding:6px;
  margin:5px;
  border-radius:6px;
}

.room-box{
  background:#2c2c3a;
  padding:15px;
  border-radius:10px;
  margin-bottom:15px;
}
</style>

</head>
<body>

<div class="container">

<div id="setup">
<h2>Imposter Game</h2>

<input id="name" placeholder="Ø§Ø³Ù…Ùƒ">
<select id="category">
<option>Ø£ÙƒÙ„Ø§Øª</option>
<option>ÙˆØ¸Ø§Ø¦Ù</option>
<option>Ø§ÙÙ„Ø§Ù… Ù…ØµØ±ÙŠØ©</option>
<option>Ø­ÙŠÙˆØ§Ù†Ø§Øª</option>
</select>

<button onclick="createRoom()">Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ©</button>

<input id="roomIdInput" placeholder="Room ID">
<button onclick="joinRoom()">Ø¯Ø®ÙˆÙ„ ØºØ±ÙØ©</button>
</div>

<!-- ROOM SECTION -->
<div id="room" style="display:none;">

<div class="room-box">
<h3>ğŸ”‘ Room ID:</h3>
<h2 id="roomIdDisplay" style="color:#00ffcc;"></h2>
<button onclick="copyRoomId()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ù€ ID</button>
</div>

<h4>ğŸ‘¥ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h4>
<div id="players"></div>

<div id="controls">
<button id="startBtn" onclick="startGame()">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
<button id="resetBtn" onclick="resetGame()" style="display:none;">
ğŸ”„ Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©
</button>
</div>

<h3 id="phaseText"></h3>

</div>

<!-- ROLE -->
<div id="role" style="display:none;">
<h2 id="roleText"></h2>
</div>

</div>

<script src="/socket.io/socket.io.js"></script>
<script>

const socket = io();
let currentRoom=null;
let isHost=false;

function createRoom(){
  const name=document.getElementById("name").value;
  const category=document.getElementById("category").value;
  socket.emit("createRoom",{name,category});
}

function joinRoom(){
  const name=document.getElementById("name").value;
  const roomId=document.getElementById("roomIdInput").value;
  socket.emit("joinRoom",{name,roomId});
}

function copyRoomId(){
  const roomId=document.getElementById("roomIdDisplay").innerText;
  navigator.clipboard.writeText(roomId);
  alert("ØªÙ… Ù†Ø³Ø® Room ID ğŸ“‹ğŸ”¥");
}

function startGame(){
  socket.emit("startGame",currentRoom);
}

function startVoting(){
  socket.emit("startVoting",currentRoom);
}

function resetGame(){
  socket.emit("resetGame",currentRoom);
}

socket.on("roomJoined",({roomId,host})=>{
  currentRoom=roomId;
  isHost=host;

  document.getElementById("setup").style.display="none";
  document.getElementById("room").style.display="block";
  document.getElementById("role").style.display="none";

  document.getElementById("roomIdDisplay").innerText=roomId;

  // Ø²Ø±Ø§Ø± Ø§Ù„Ù€ Host Ø¨Ø³
  if(isHost){
    document.getElementById("startBtn").style.display="inline-block";
    document.getElementById("resetBtn").style.display="inline-block";
  }else{
    document.getElementById("startBtn").style.display="none";
    document.getElementById("resetBtn").style.display="none";
  }
});

socket.on("playersUpdate",(players)=>{
  const container=document.getElementById("players");
  container.innerHTML="";

  players.forEach(p=>{
    const div=document.createElement("div");
    div.className="player";
    div.innerText=p.name;
    container.appendChild(div);
  });
});

socket.on("role",(data)=>{
  document.getElementById("role").style.display="block";

  if(data.role==="imposter"){
    document.getElementById("roleText").innerText="ğŸ˜ˆ Ø£Ù†Øª Imposter";
  }else{
    document.getElementById("roleText").innerText="Ø§Ù„ÙƒÙ„Ù…Ø©: "+data.word;
  }
});

socket.on("phaseUpdate",(phase)=>{
  if(phase==="waiting"){
    // Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù€ Setup Ø¨Ø¹Ø¯ Ø§Ù„Ù€ Reset
    document.getElementById("room").style.display="none";
    document.getElementById("role").style.display="none";
    document.getElementById("setup").style.display="block";

    alert("ğŸ”„ ØªÙ… Ø¨Ø¯Ø¡ Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©");
  }
});

socket.on("gameResult",(data)=>{
  alert(data.winner);
});

socket.on("errorMessage",(msg)=>{
  alert(msg);
});

</script>

</body>
</html>